<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>文件管理器 - Nyaser Maps Downloader</title>
    <script>
      const convertFileSrc = window.__TAURI__.core.convertFileSrc;
      const mainCss = convertFileSrc("filemanager/main.css", "asset");
      const mainJs = convertFileSrc("filemanager/main.js", "asset");
      const link = document.createElement("link");
      link.setAttribute("rel", "stylesheet");
      link.setAttribute("href", mainCss);
      document.head.appendChild(link);
      const script = document.createElement("script");
      script.setAttribute("src", mainJs);
      document.head.appendChild(script);
    </script>
  </head>

  <body>
    <div class="container">
      <h1>Nyaser Maps Downloader - 文件管理器</h1>
      <div class="data-dir-config">
        <div class="data-dir-info">
          <label for="dataDir">数据存储目录：</label>
          <span id="dataDir">正在加载...</span>
        </div>
        <button class="change-dir-btn" id="changeDirBtn">修改</button>
      </div>
      <div class="action-buttons">
        <button class="refresh-btn" id="refreshBtn">刷新</button>
        <button class="select-all-btn" id="selectAllBtn">全选</button>
        <button class="select-mounted-btn" id="selectMountedBtn">
          全选已载
        </button>
        <button class="select-unmounted-btn" id="selectUnmountedBtn">
          全选未载
        </button>
        <button class="batch-mount-btn" id="batchMountBtn" disabled>
          挂载
        </button>
        <button class="batch-unmount-btn" id="batchUnmountBtn" disabled>
          卸载
        </button>
        <button class="batch-delete-btn" id="batchDeleteBtn" disabled>
          删除
        </button>
      </div>
      <div class="file-list" id="fileList">
        <p class="no-files">正在加载...</p>
      </div>
    </div>

    <template id="groupItemTemplate">
      <div class="group-item">
        <div class="group-header" data-group="{{groupKey}}">
          <div class="group-checkbox-container">
            <label class="file-checkbox-container">
              <input
                type="checkbox"
                class="group-checkbox"
                data-group="{{groupKey}}"
              />
              <span class="checkbox-custom"></span>
            </label>
            <span class="group-toggle">▶</span>
          </div>
          <div class="group-info">{{displayGroupName}}</div>
          <div class="group-stats">{{fileCount}} 个文件 · {{totalSize}}</div>
          <div class="group-actions">
            <button
              class="group-mount-btn {{groupMountBtnClass}}"
              data-group="{{groupKey}}"
              data-mounted="{{groupMounted}}"
            >
              {{groupMountBtnText}}
            </button>
            <button
              class="delete-btn group-delete-btn"
              data-group="{{groupKey}}"
            >
              删除
            </button>
          </div>
        </div>
        <div class="group-content" id="{{groupId}}">
          <div class="group-files"></div>
        </div>
      </div>
    </template>

    <template id="fileItemTemplate">
      <div class="file-item" data-group="{{groupKey}}">
        <div class="file-name">{{displayName}}</div>
        <div class="file-size">{{fileSize}}</div>
        <div class="file-mount-status">
          <span class="mount-indicator {{mountStatusClass}}"
            >{{mountStatusText}}</span
          >
        </div>
      </div>
    </template>
  </body>
</html>
